<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>wkpool: Topology-based Geometry Handling • wkpool</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="wkpool: Topology-based Geometry Handling">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wkpool</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/wkpool.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/wkpool-vignette-segments.html">Segments: the atoms of geometry</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hypertidy/wkpool/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>wkpool: Topology-based Geometry Handling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hypertidy/wkpool/blob/main/vignettes/wkpool.Rmd" class="external-link"><code>vignettes/wkpool.Rmd</code></a></small>
      <div class="hidden name"><code>wkpool.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="why-topology">Why topology?<a class="anchor" aria-label="anchor" href="#why-topology"></a>
</h2>
<p><strong>wkpool</strong> represents geometry as segments referencing a
shared vertex pool. Topology emerges naturally: shared edges,
neighbours, and ring structure become simple lookups.</p>
<p>Simple features store geometry as complete coordinate sequences per
feature. Two adjacent polygons duplicate their shared boundary —
wasteful in entropy and requiring spatial predicates (GEOS) to
rediscover adjacency.</p>
</div>
<div class="section level2">
<h2 id="basic-workflow">Basic workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h2>
<p>Create two adjacent squares sharing an edge:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/wk/" class="external-link">wk</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hypertidy/wkpool" class="external-link">wkpool</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Two adjacent unit squares</span></span>
<span><span class="va">poly1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paleolimbot.github.io/wk/reference/wkt.html" class="external-link">wkt</a></span><span class="op">(</span><span class="st">"POLYGON ((0 0, 1 0, 1 1, 0 1, 0 0))"</span><span class="op">)</span></span>
<span><span class="va">poly2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paleolimbot.github.io/wk/reference/wkt.html" class="external-link">wkt</a></span><span class="op">(</span><span class="st">"POLYGON ((1 0, 2 0, 2 1, 1 1, 1 0))"</span><span class="op">)</span></span>
<span><span class="va">geoms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">poly1</span>, <span class="va">poly2</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="establish-topology">Establish topology<a class="anchor" aria-label="anchor" href="#establish-topology"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pool</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/establish_topology.html">establish_topology</a></span><span class="op">(</span><span class="va">geoms</span><span class="op">)</span></span>
<span><span class="va">pool</span></span>
<span><span class="co">#&gt; &lt;wkpool[8 segments, 10 vertices]&gt;</span></span>
<span><span class="co">#&gt; [1] &lt;segment: 1-&gt;2&gt;  &lt;segment: 2-&gt;3&gt;  &lt;segment: 3-&gt;4&gt;  &lt;segment: 4-&gt;5&gt; </span></span>
<span><span class="co">#&gt; [5] &lt;segment: 6-&gt;7&gt;  &lt;segment: 7-&gt;8&gt;  &lt;segment: 8-&gt;9&gt;  &lt;segment: 9-&gt;10&gt;</span></span></code></pre></div>
<p>At this stage, vertices are indexed but not yet merged — the shared
edge exists as duplicate coordinate pairs.</p>
</div>
<div class="section level3">
<h3 id="inspect-the-raw-state">Inspect the raw state<a class="anchor" aria-label="anchor" href="#inspect-the-raw-state"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/topology_report.html">topology_report</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n_vertices_raw</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_vertices_unique</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_duplicate_vertices</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_near_miss_vertices</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_segments</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_shared_edges</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_features</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="access-the-pool-components">Access the pool components<a class="anchor" aria-label="anchor" href="#access-the-pool-components"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wkpool-accessors.html">pool_vertices</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt;    .vx x y</span></span>
<span><span class="co">#&gt; 1    1 0 0</span></span>
<span><span class="co">#&gt; 2    2 1 0</span></span>
<span><span class="co">#&gt; 3    3 1 1</span></span>
<span><span class="co">#&gt; 4    4 0 1</span></span>
<span><span class="co">#&gt; 5    5 0 0</span></span>
<span><span class="co">#&gt; 6    6 1 0</span></span>
<span><span class="co">#&gt; 7    7 2 0</span></span>
<span><span class="co">#&gt; 8    8 2 1</span></span>
<span><span class="co">#&gt; 9    9 1 1</span></span>
<span><span class="co">#&gt; 10  10 1 0</span></span>
<span><span class="fu"><a href="../reference/wkpool-accessors.html">pool_segments</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt;   .vx0 .vx1 .feature</span></span>
<span><span class="co">#&gt; 1    1    2        1</span></span>
<span><span class="co">#&gt; 2    2    3        1</span></span>
<span><span class="co">#&gt; 3    3    4        1</span></span>
<span><span class="co">#&gt; 4    4    5        1</span></span>
<span><span class="co">#&gt; 5    6    7        2</span></span>
<span><span class="co">#&gt; 6    7    8        2</span></span>
<span><span class="co">#&gt; 7    8    9        2</span></span>
<span><span class="co">#&gt; 8    9   10        2</span></span>
<span><span class="fu"><a href="../reference/wkpool-accessors.html">pool_feature</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 1 1 1 2 2 2 2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="merge-coincident-vertices">Merge coincident vertices<a class="anchor" aria-label="anchor" href="#merge-coincident-vertices"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pool</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_coincident.html">merge_coincident</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/topology_report.html">topology_report</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n_vertices_raw</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_vertices_unique</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_duplicate_vertices</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_near_miss_vertices</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_segments</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_shared_edges</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_features</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>After merging, shared edge vertices reference the same pool
indices.</p>
</div>
</div>
<div class="section level2">
<h2 id="adjacency-discovery">Adjacency discovery<a class="anchor" aria-label="anchor" href="#adjacency-discovery"></a>
</h2>
<div class="section level3">
<h3 id="shared-edges">Shared edges<a class="anchor" aria-label="anchor" href="#shared-edges"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/find_shared_edges.html">find_shared_edges</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt;   edge_key .vx0 .vx1 .feature segment_idx features</span></span>
<span><span class="co">#&gt; 2      2-3    2    3        1           2     1, 2</span></span>
<span><span class="co">#&gt; 8      2-3    2    3        2           8     1, 2</span></span></code></pre></div>
<p>Returns segment indices that appear in multiple features.</p>
</div>
<div class="section level3">
<h3 id="internal-boundaries">Internal boundaries<a class="anchor" aria-label="anchor" href="#internal-boundaries"></a>
</h3>
<p>For polygon data, shared edges with <em>opposite</em> winding
indicate true internal boundaries (not self-shared rings):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/find_internal_boundaries.html">find_internal_boundaries</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;wkpool[2 segments, 6 vertices]&gt;</span></span>
<span><span class="co">#&gt; [1] &lt;segment: 2-&gt;3&gt; &lt;segment: 3-&gt;2&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="neighbour-graph">Neighbour graph<a class="anchor" aria-label="anchor" href="#neighbour-graph"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/find_neighbours.html">find_neighbours</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt;   feature_a feature_b</span></span>
<span><span class="co">#&gt; 3         1         2</span></span></code></pre></div>
<p>Returns a data frame of feature pairs that share an edge.</p>
</div>
</div>
<div class="section level2">
<h2 id="ring-and-cycle-analysis">Ring and cycle analysis<a class="anchor" aria-label="anchor" href="#ring-and-cycle-analysis"></a>
</h2>
<p>Topology enables ring discovery without parsing WKT structure.</p>
<div class="section level3">
<h3 id="find-closed-cycles">Find closed cycles<a class="anchor" aria-label="anchor" href="#find-closed-cycles"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cycles</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_cycles.html">find_cycles</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="va">cycles</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 1 2 3 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 2 5 6 3</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="classify-by-winding">Classify by winding<a class="anchor" aria-label="anchor" href="#classify-by-winding"></a>
</h3>
<p>Signed area distinguishes outer rings from holes. Following the SF
convention, negative area indicates an outer ring, positive indicates a
hole:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Area of the first cycle</span></span>
<span><span class="fu"><a href="../reference/cycle_signed_area.html">cycle_signed_area</a></span><span class="op">(</span><span class="va">cycles</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="../reference/wkpool-accessors.html">pool_vertices</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span></span>
<span><span class="co"># Classify all cycles</span></span>
<span><span class="fu"><a href="../reference/classify_cycles.html">classify_cycles</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt;   cycle area type</span></span>
<span><span class="co">#&gt; 1     1    1 hole</span></span>
<span><span class="co">#&gt; 2     2    1 hole</span></span></code></pre></div>
<p>Use <code><a href="../reference/reverse_cycle.html">reverse_cycle()</a></code> to flip winding if needed.</p>
</div>
</div>
<div class="section level2">
<h2 id="arc-node-topology">Arc-node topology<a class="anchor" aria-label="anchor" href="#arc-node-topology"></a>
</h2>
<p>Arcs are maximal sequences of segments passing through degree-2
vertices. Nodes are vertices where degree ≠ 2 (branch points or
endpoints).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vertex_degree.html">vertex_degree</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt; 1 2 3 4 5 6 </span></span>
<span><span class="co">#&gt; 2 4 4 2 2 2</span></span>
<span><span class="fu"><a href="../reference/find_nodes.html">find_nodes</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2 3</span></span>
<span><span class="fu"><a href="../reference/find_arcs.html">find_arcs</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 2 1 4 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 2 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 2 5 6 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 2 3</span></span>
<span><span class="fu"><a href="../reference/arc_node_summary.html">arc_node_summary</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n_vertices</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_nodes</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_arcs</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $degree_distribution</span></span>
<span><span class="co">#&gt; deg</span></span>
<span><span class="co">#&gt; 2 4 </span></span>
<span><span class="co">#&gt; 4 2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $arc_length_distribution</span></span>
<span><span class="co">#&gt; arc_lengths</span></span>
<span><span class="co">#&gt; 1 3 </span></span>
<span><span class="co">#&gt; 2 2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean_arc_length</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="round-trip-to-wkt">Round-trip to WKT<a class="anchor" aria-label="anchor" href="#round-trip-to-wkt"></a>
</h2>
<p>Convert topology back to standard geometry formats:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Arcs as linestrings</span></span>
<span><span class="fu"><a href="../reference/arcs_to_wkt.html">arcs_to_wkt</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;wk_wkt[4]&gt;</span></span>
<span><span class="co">#&gt; [1] LINESTRING (1 0, 0 0, 0 1, 1 1) LINESTRING (1 0, 1 1)          </span></span>
<span><span class="co">#&gt; [3] LINESTRING (1 0, 2 0, 2 1, 1 1) LINESTRING (1 0, 1 1)</span></span>
<span></span>
<span><span class="co"># Cycles as polygons</span></span>
<span><span class="fu"><a href="../reference/cycles_to_wkt.html">cycles_to_wkt</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;wk_wkt[0] with CRS=NA&gt;</span></span>
<span></span>
<span><span class="co"># Raw segments</span></span>
<span><span class="fu"><a href="../reference/segments_to_wkt.html">segments_to_wkt</a></span><span class="op">(</span><span class="va">pool</span>, type <span class="op">=</span> <span class="st">"linestring"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt; &lt;wk_wkt[3]&gt;</span></span>
<span><span class="co">#&gt; [1] LINESTRING (0 0, 1 0) LINESTRING (1 0, 1 1) LINESTRING (1 1, 0 1)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="triangulation-integration">Triangulation integration<a class="anchor" aria-label="anchor" href="#triangulation-integration"></a>
</h2>
<p>The pool maps directly to constrained triangulation inputs.</p>
<div class="section level3">
<h3 id="rtriangle-pslg">RTriangle (PSLG)<a class="anchor" aria-label="anchor" href="#rtriangle-pslg"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pslg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_pslg.html">as_pslg</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">pslg</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ P: num [1:6, 1:2] 0 1 1 0 2 2 0 0 1 1 ...</span></span>
<span><span class="co">#&gt;  $ S: int [1:8, 1:2] 1 2 3 4 2 5 6 3 2 3 ...</span></span></code></pre></div>
<p>For polygons with holes, use <code><a href="../reference/hole_points.html">hole_points()</a></code> to generate
interior points that tell the triangulator which regions to exclude:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A polygon with a hole</span></span>
<span><span class="va">holed</span> <span class="op">&lt;-</span> <span class="fu">wk</span><span class="fu">::</span><span class="fu"><a href="https://paleolimbot.github.io/wk/reference/wkb.html" class="external-link">as_wkb</a></span><span class="op">(</span></span>
<span>  <span class="st">"POLYGON ((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 3 1, 3 3, 1 3, 1 1))"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">hp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/establish_topology.html">establish_topology</a></span><span class="op">(</span><span class="va">holed</span><span class="op">)</span></span>
<span><span class="va">hp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_coincident.html">merge_coincident</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span></span>
<span><span class="va">pslg_h</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_pslg.html">as_pslg</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span></span>
<span><span class="va">holes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hole_points.html">hole_points</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span></span>
<span><span class="va">tri</span> <span class="op">&lt;-</span> <span class="fu">RTriangle</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RTriangle/man/triangulate.html" class="external-link">triangulate</a></span><span class="op">(</span></span>
<span>  <span class="fu">RTriangle</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RTriangle/man/pslg.html" class="external-link">pslg</a></span><span class="op">(</span>P <span class="op">=</span> <span class="va">pslg_h</span><span class="op">$</span><span class="va">P</span>, S <span class="op">=</span> <span class="va">pslg_h</span><span class="op">$</span><span class="va">S</span>, H <span class="op">=</span> <span class="va">holes</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="subsetting-and-combining">Subsetting and combining<a class="anchor" aria-label="anchor" href="#subsetting-and-combining"></a>
</h2>
<p>Pools support <code>[</code> subsetting — the full vertex pool is
retained:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pool</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#&gt; &lt;wkpool[4 segments, 6 vertices]&gt;</span></span>
<span><span class="co">#&gt; [1] &lt;segment: 1-&gt;2&gt; &lt;segment: 2-&gt;3&gt; &lt;segment: 3-&gt;4&gt; &lt;segment: 4-&gt;1&gt;</span></span></code></pre></div>
<p>Combine pools from different sources:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pool_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/establish_topology.html">establish_topology</a></span><span class="op">(</span><span class="fu">wk</span><span class="fu">::</span><span class="fu"><a href="https://paleolimbot.github.io/wk/reference/wkt.html" class="external-link">wkt</a></span><span class="op">(</span><span class="st">"POLYGON ((0 0, 1 0, 1 1, 0 1, 0 0))"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pool_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/establish_topology.html">establish_topology</a></span><span class="op">(</span><span class="fu">wk</span><span class="fu">::</span><span class="fu"><a href="https://paleolimbot.github.io/wk/reference/wkt.html" class="external-link">wkt</a></span><span class="op">(</span><span class="st">"POLYGON ((5 5, 6 5, 6 6, 5 6, 5 5))"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pool_combine.html">pool_combine</a></span><span class="op">(</span><span class="va">pool_a</span>, <span class="va">pool_b</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;wkpool[8 segments, 10 vertices]&gt;</span></span>
<span><span class="co">#&gt; [1] &lt;segment: 1-&gt;2&gt;  &lt;segment: 2-&gt;3&gt;  &lt;segment: 3-&gt;4&gt;  &lt;segment: 4-&gt;5&gt; </span></span>
<span><span class="co">#&gt; [5] &lt;segment: 6-&gt;7&gt;  &lt;segment: 7-&gt;8&gt;  &lt;segment: 8-&gt;9&gt;  &lt;segment: 9-&gt;10&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pool</span><span class="op">)</span></span></code></pre></div>
<p><img src="wkpool_files/figure-html/plot-1.png" class="r-plt" alt="" width="576"></p>
</div>
<div class="section level2">
<h2 id="related-work">Related Work<a class="anchor" aria-label="anchor" href="#related-work"></a>
</h2>
<div class="section level3">
<h3 id="core-topologyvertex-pool-hypertidy-ecosystem">Core topology/vertex-pool (hypertidy ecosystem)<a class="anchor" aria-label="anchor" href="#core-topologyvertex-pool-hypertidy-ecosystem"></a>
</h3>
<table class="table">
<colgroup>
<col width="22%">
<col width="17%">
<col width="60%">
</colgroup>
<thead><tr class="header">
<th>Package</th>
<th>Where</th>
<th>Relationship to wkpool</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="https://CRAN.R-project.org/package=silicate" class="external-link">silicate</a></td>
<td>CRAN</td>
<td>Mature predecessor — <code>SC</code> (edge-vertex), <code>ARC</code>
(shared boundaries), <code>PATH</code> models. wkpool is the
<code>wk</code>-native successor</td>
</tr>
<tr class="even">
<td><a href="https://CRAN.R-project.org/package=unjoin" class="external-link">unjoin</a></td>
<td>CRAN</td>
<td>Vertex deduplication via data frame normalization — used internally
by silicate</td>
</tr>
<tr class="odd">
<td><a href="https://CRAN.R-project.org/package=wk" class="external-link">wk</a></td>
<td>CRAN</td>
<td>Path/geometry indexing via <code><a href="https://paleolimbot.github.io/wk/reference/wk_vertices.html" class="external-link">wk_coords()</a></code>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="meshtriangulation">Mesh/triangulation<a class="anchor" aria-label="anchor" href="#meshtriangulation"></a>
</h3>
<table class="table">
<colgroup>
<col width="39%">
<col width="30%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Package</th>
<th>Where</th>
<th>Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="https://CRAN.R-project.org/package=RTriangle" class="external-link">RTriangle</a></td>
<td>CRAN</td>
<td>Shewchuk’s Triangle — constrained Delaunay, <code><a href="../reference/as_pslg.html">as_pslg()</a></code>
target</td>
</tr>
<tr class="even">
<td><a href="https://CRAN.R-project.org/package=decido" class="external-link">decido</a></td>
<td>CRAN</td>
<td>Earcut — fast, returns vertex indices (implicit pool),
<code>as_decido()</code> target</td>
</tr>
<tr class="odd">
<td><a href="https://CRAN.R-project.org/package=sfdct" class="external-link">sfdct</a></td>
<td>CRAN</td>
<td>RTriangle wrapper for sf objects</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="adjacency-computed-not-stored">Adjacency (computed, not stored)<a class="anchor" aria-label="anchor" href="#adjacency-computed-not-stored"></a>
</h3>
<table class="table">
<colgroup>
<col width="34%">
<col width="26%">
<col width="38%">
</colgroup>
<thead><tr class="header">
<th>Package</th>
<th>Where</th>
<th>Approach</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="https://CRAN.R-project.org/package=sfdep" class="external-link">sfdep</a></td>
<td>CRAN</td>
<td>
<code>st_contiguity()</code> computes on-demand</td>
</tr>
<tr class="even">
<td><a href="https://CRAN.R-project.org/package=sf" class="external-link">sf</a></td>
<td>CRAN</td>
<td>
<code>st_touches()</code>, <code>st_relate()</code> via GEOS —
recomputes each time</td>
</tr>
</tbody>
</table>
<p><strong>Key distinction</strong>: wkpool differs from sf/spdep by
<em>storing</em> topology (shared edges are explicit) rather than
<em>computing</em> it on demand via GEOS. It’s a lightweight,
<code>wk</code>-native evolution of silicate’s approach.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael Sumner.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
